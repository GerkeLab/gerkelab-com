---
title: When does {dtplyr} help me?
description: Investigating where efficiency gains occur when ingesting flat files with dtplyr
author: 
  - "Travis Gerke"
date: '2019-11-14'
slug: dtplyr-and-fread
categories:
  - R
tags:
  - Tips
hero_bg: "/img/hero/ethan-weil-528367-unsplash.jpg"
hero_credit: '[Ethan Weil](https://unsplash.com/@weilstyle?utm_medium=referral&amp;utm_campaign=photographer-credit).'
---



<p>This post explores where to expect efficiency gains when using the new [<a href="https://dtplyr.tidyverse.org/">dtplyr</a>]}{.pkg} to import and manipulate large flat files.</p>
<pre><code>## ── Attaching packages ────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.2.1           ✔ purrr   0.3.3      
## ✔ tibble  2.1.3           ✔ dplyr   0.8.3      
## ✔ tidyr   0.8.99.9000     ✔ stringr 1.4.0      
## ✔ readr   1.3.1           ✔ forcats 0.4.0</code></pre>
<pre><code>## ── Conflicts ───────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::between()   masks data.table::between()
## ✖ dplyr::filter()    masks stats::filter()
## ✖ dplyr::first()     masks data.table::first()
## ✖ dplyr::lag()       masks stats::lag()
## ✖ dplyr::last()      masks data.table::last()
## ✖ purrr::transpose() masks data.table::transpose()</code></pre>
<pre class="r"><code># Install packages if you need to
install.packages(c(&quot;tidyverse&quot;, &quot;fs&quot;))

library(data.table)
library(dtplyr)
library(tidyverse)
library(microbenchmark)</code></pre>
<div id="problem" class="section level2">
<h2>Problem</h2>
<p>This week, we got the following exciting announcement from Hadley Wickham regarding a big [<a href="https://dtplyr.tidyverse.org/">dtplyr</a>]}{.pkg} release!</p>
<div style="width: 100%; display: flex; align-content: center;">
<div style="margin: auto;">
<img src="/blog/2019-11-14-dtplyr-and-fread/dtplyr-tweet.png" style="max-width: 600px" />
</div>
</div>
<p>We would like to read in all of the CSV files inside the directory and build one large dataset by merging each of the smaller data sets together.</p>
</div>
<div id="example-data" class="section level2">
<h2>Example Data</h2>
<p>To make the example more concrete, we’ll use a <a href="https://www.kaggle.com/jameslko/gun-violence-data/data">dataset provided by the Gun Violence Archive and available in Kaggle</a> showing the yearly number of e-referrals per hospital department, where the data from each year reside in individual CSV files.</p>
<p>Once we’ve extracted the zip file or downloaded the CSV files a single folder, we store the location of the unzipped folder in <code>data_dir</code>.</p>
</div>
<div id="import-all-the-files" class="section level2">
<h2>Import all the Files</h2>
<div id="start-with-one-file" class="section level3">
<h3>Start with one file</h3>
</div>
</div>
